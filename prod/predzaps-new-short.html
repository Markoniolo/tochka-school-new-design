<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2, minimum-scale=1.0">
  <meta name="author" content="Точка знаний">
  <meta name="description" content="Точка знаний">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="assets/css/main.css" />
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="assets/img/favicon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/img/favicon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/img/favicon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/img/favicon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="assets/img/favicon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="assets/img/favicon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="assets/img/favicon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="assets/img/favicon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-128.png" sizes="128x128">
  <meta name="application-name" content=" ">
  <meta name="msapplication-TileColor" content="#FFFFFF">
  <meta name="msapplication-TileImage" content="assets/img/favicon/mstile-144x144.png">
  <meta name="msapplication-square70x70logo" content="assets/img/favicon/mstile-70x70.png">
  <meta name="msapplication-square150x150logo" content="assets/img/favicon/mstile-150x150.png">
  <meta name="msapplication-wide310x150logo" content="assets/img/favicon/mstile-310x150.png">
  <meta name="msapplication-square310x310logo" content="assets/img/favicon/mstile-310x310.png">
  <meta property="og:title" content="Точка знаний">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Точка знаний">
  <meta property="og:description" content="Занятия для детей с 1 по 11 класс">
  <meta property="og:image" content="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
  <link rel="image_src" href="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
  <meta property="vk:image" content="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
  <meta property="og:url" content="https://tochka-school.ru">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="pointschool">
  <meta name="twitter:title" content="Точка знаний">
  <meta name="twitter:description" content="Занятия для детей с 1 по 11 класс">
  <meta name="twitter:image" content="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
  <title>Предзапись новая короткая</title>
  <meta property="og:title" content="Предзапись новая короткая" />
</head>

<body>
  <div class="sticky-header sticky-header_no-margin">
    <header class="header short header_predzaps-new-short">
      <div class="header__cont cont">
        <div class="header__layer"></div>
        <div class="header__area">
          <div class="header__logo">
            <img class="header__logo-image" src="assets/img/logo_new-year.svg" alt="">
          </div>
        </div>
      </div>
    </header>
  </div>
  <main class="wrapper">
    <div class="predzaps-new-cap predzaps-new-cap_short">
      <div class="cont">
        <div class="predzaps-new-cap__wrap">
          <div class="predzaps-new-cap__area">
            <div class="predzaps-new-cap__tag">Долгожданное событие для&nbsp;учеников и родителей</div>
            <h1 class="predzaps-new-cap__caption">Предзапись на занятия в&nbsp;следующем учебном&nbsp;году</h1>
            <ul class="predzaps-new-cap__list">
              <li class="predzaps-new-cap__item">Получить самую большую скидку в году</li>
              <li class="predzaps-new-cap__item">Сэкономить от 8 000 до 53 000 рублей</li>
              <li class="predzaps-new-cap__item">Занять место на обучении раньше остальных</li>
            </ul>
            <div class="predzaps-new-cap__counter">
              <div class="predzaps-new-cap__counter-value">10 542</div>
              <div class="predzaps-new-cap__counter-note">Человек уже записалось</div>
            </div>
          </div>
          <form class="predzaps-new-cap__form" data-request-validate>
            <div class="predzaps-new-cap__headline">Быстрая регистрация</div>
            <div class="predzaps-new-cap__inner">
              <input class="input_utm" name="utm" type="hidden" value="">
              <input type="hidden" id="page_name" name="page_name" value="https://cms-dev.tochka-school.ru/blog/voprosy-dlya-podrostkov-chto-polezno-i-interesno-obsudit-do-15-let">
              <input class="predzaps-new-cap__input input-white" placeholder="Имя родителя" type="text" name="name">
              <input class="predzaps-new-cap__input input-white" placeholder="Телефон родителя" data-phone-pattern type="tel" required data-element="input-phone-intl" name="phone">
              <input name="tel" type="hidden" required data-element="input-phone-hidden">
              <input class="predzaps-new-cap__input input-white" placeholder="E-mail родителя" type="email" name="email">
              <button class="predzaps-new-cap__submit btn-orange btn-warning">Оставить заявку</button>
              <label class="predzaps-new-cap__label checkbox-white-label">
                <input class="predzaps-new-cap__checkbox checkbox-white-input" name="policy" type="checkbox">
                <div class="predzaps-new-cap__checkbox-view checkbox-white-input-view"></div>
                <div class="predzaps-new-cap__checkbox-text checkbox-white-text">
                  Даю
                  <a href="https://cms-dev.tochka-school.ru/storage/app/media/Dokumenti/Soglasie_na_obrabotku_personalnih_dannih_OOO.pdf" target="_blank">Согласие</a>
                  на обработку персональных
                  данных в соответствии с
                  <a href="https://cms-dev.tochka-school.ru/storage/app/media/Dokumenti/Politika_obrabotki_personalnih_dannih_OOO.pdf" target="_blank">Политикой</a>
                </div>
              </label>
              <label class="predzaps-new-cap__label checkbox-white-label">
                <input class="predzaps-new-cap__checkbox checkbox-white-input" name="news" type="checkbox">
                <div class="predzaps-new-cap__checkbox-view checkbox-white-input-view"></div>
                <div class="predzaps-new-cap__checkbox-text checkbox-white-text">
                  Согласие на получение
                  <a href="https://cms-dev.tochka-school.ru/storage/app/media/Dokumenti/Soglasie_na_reklamnuyu_rassilku_OOO.pdf" target="_blank">информационной рассылки</a>. Мы напомним Вам о самой низкой цене в году
                </div>
              </label>
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>
  <form class="modal-order-new" id="modal-order-new" data-element="order-form" data-docex="/_thanks" data-request-validate>
    <div class="captcha"></div>
    <div class="modal-order-new__title" data-default-title="Подобрать занятия">Подобрать занятия</div>
    <input class="modal-order-new__input modal-order-new__input_sms" name="sms_code" type="text" placeholder="код подтверждения">
    <input type="hidden" name="banner_v">
    <input class="modal-exter__input" type="hidden" value="qwe">
    <input class="input_utm" name="utm" type="hidden" value="">
    <input type="hidden" id="page_name" name="page_name" value="https://cms-dev.tochka-school.ru">
    <div class="modal-order-new__select">
      <div class="modal-order-new__select-top">
        <div class="modal-order-new__select-placeholder">Класс</div>
      </div>
      <div class="modal-order-new__select-wrap">
        <div class="modal-order-new__select-close">
          <svg viewbox="0 0 29 29" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect width="29" height="29" rx="14.5" fill="#6784C3" fill-opacity="0.21"></rect>
            <path d="M19.9002 20.4669C20.0127 20.4669 20.1226 20.4336 20.2161 20.3711C20.3096 20.3087 20.3824 20.2199 20.4255 20.116C20.4685 20.0122 20.4798 19.8979 20.4578 19.7876C20.4359 19.6773 20.3817 19.576 20.3022 19.4965L9.79824 8.99255C9.69163 8.88594 9.54704 8.82605 9.39627 8.82605C9.2455 8.82605 9.10091 8.88594 8.9943 8.99255C8.88769 9.09916 8.8278 9.24375 8.8278 9.39452C8.8278 9.54529 8.88769 9.68988 8.9943 9.79649L19.4983 20.3005C19.551 20.3533 19.6137 20.3952 19.6827 20.4238C19.7516 20.4523 19.8256 20.467 19.9002 20.4669Z" fill="#6784C3"></path>
            <path d="M9.3963 20.4669C9.47096 20.467 9.54491 20.4523 9.61389 20.4238C9.68287 20.3952 9.74553 20.3533 9.79827 20.3005L20.3022 9.79649C20.4089 9.68988 20.4688 9.54529 20.4688 9.39452C20.4688 9.24375 20.4089 9.09916 20.3022 8.99255C20.1956 8.88594 20.051 8.82605 19.9003 8.82605C19.7495 8.82605 19.6049 8.88594 19.4983 8.99255L8.99433 19.4965C8.91482 19.576 8.86067 19.6773 8.83873 19.7876C8.81678 19.8979 8.82804 20.0122 8.87107 20.116C8.9141 20.2199 8.98697 20.3087 9.08046 20.3711C9.17395 20.4336 9.28387 20.4669 9.3963 20.4669Z" fill="#6784C3"></path>
          </svg>
        </div>
        <div class="modal-order-new__select-title">Выберите класс</div>
        <div class="modal-order-new__select-list">
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="Дошкольник">
            <div class="modal-order-new__select-view">Дошкольник</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="1 класс">
            <div class="modal-order-new__select-view">1 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="2 класс">
            <div class="modal-order-new__select-view">2 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="3 класс">
            <div class="modal-order-new__select-view">3 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="4 класс">
            <div class="modal-order-new__select-view">4 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="5 класс">
            <div class="modal-order-new__select-view">5 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="6 класс">
            <div class="modal-order-new__select-view">6 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="7 класс">
            <div class="modal-order-new__select-view">7 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="8 класс">
            <div class="modal-order-new__select-view">8 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="9 класс">
            <div class="modal-order-new__select-view">9 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="10 класс">
            <div class="modal-order-new__select-view">10 класс</div>
          </label>
          <label class="modal-order-new__select-item">
            <input class="modal-order-new__select-input" type="radio" name="modal-order-new-class" value="11 класс">
            <div class="modal-order-new__select-view">11 класс</div>
          </label>
        </div>
      </div>
    </div>
    <input class="modal-order-new__input" name="phone" placeholder="Номер телефона" type="tel" required data-element="input-phone-intl">
    <input name="tel" type="hidden" required data-element="input-phone-hidden">
    <input class="modal-order-new__input" name="name" placeholder="Имя родителя" type="text">
    <button class="modal-order-new__button btn-warning">Записаться</button>
    <label class="modal-order-new__checkbox">
      <input class="modal-order-new__checkbox-input" name="policy" type="checkbox">
      <div class="modal-order-new__checkbox-view"></div>
      <div class="modal-order-new__checkbox-text">
        Даю
        <a href="https://tochka-school.ru/storage/app/media/Dokumenti/Soglasie_na_obrabotku_personalnih_dannih_OOO.pdf" target="_blank">Согласие</a>
        на обработку персональных данных в соответствии с
        <a href="https://tochka-school.ru/storage/app/media/Dokumenti/Politika_obrabotki_personalnih_dannih_OOO.pdf" target="_blank">Политикой.</a>
      </div>
    </label>
    <label class="modal-order-new__checkbox">
      <input class="modal-order-new__checkbox-input" name="news" type="checkbox">
      <div class="modal-order-new__checkbox-view"></div>
      <div class="modal-order-new__checkbox-text">
        Согласен на
        <a href="https://tochka-school.ru/storage/app/media/Dokumenti/Soglasie_na_reklamnuyu_rassilku_OOO.pdf" target="_blank">получение рекламы</a>
      </div>
    </label>
  </form>
  <div class="footer-quiz">
    <div class="cont">
      <div class="footer-quiz__wrap">
        <img class="footer-quiz__image" src="assets/img/logo_white.svg" alt="">
        <div class="footer-quiz__left">
          <div class="footer-quiz__text">ООО «Точка Знаний»
            <br>ИНН 2311347344
            <br>ОГРН 232300017817
          </div>
          <a class="footer-quiz__license" href="#">Лицензия № Л035-01218-23/00650937</a>
          <div class="footer-quiz__docs">
            <div class="footer-quiz__docs-span">Документация
              <svg class="plus" width="9" height="9" viewbox="0 0 9 9" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.0022 4.5C9.0022 5.01991 8.58073 5.44138 8.06082 5.44138H0.943577C0.423667 5.44138 0.00219727 5.01991 0.00219727 4.5C0.00219727 3.98009 0.423667 3.55862 0.943577 3.55862H8.06082C8.58073 3.55862 9.0022 3.98009 9.0022 4.5ZM5.43538 8.06682C5.43538 8.5822 5.01758 9 4.5022 9C3.98682 9 3.56902 8.5822 3.56902 8.06682V0.93318C3.56902 0.417799 3.98682 0 4.5022 0C5.01758 0 5.43538 0.417799 5.43538 0.93318V8.06682Z" fill="white" fill-opacity="0.65"></path>
              </svg>
              <svg class="minus" width="9" height="3" viewbox="0 0 9 3" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9 1.49997C9 2.01988 8.57853 2.44135 8.05862 2.44135H0.94138C0.42147 2.44135 0 2.01988 0 1.49997C0 0.980064 0.42147 0.558594 0.94138 0.558594H8.05862C8.57853 0.558594 9 0.980064 9 1.49997ZM5.43318 1.49998C5.43318 2.01536 5.01538 2.44135 4.5 2.44135C3.98462 2.44135 3.56682 2.01536 3.56682 1.49998C3.56682 0.984604 3.98461 0.558614 4.49999 0.558607C5.01537 0.5586 5.43318 0.984594 5.43318 1.49998Z" fill="white" fill-opacity="0.65"></path>
              </svg>
            </div>
            <div class="footer-quiz__docs-list">
              <a class="footer-quiz__docs-item" href="#">Политика обработки персональных данных</a>
              <a class="footer-quiz__docs-item" href="#">Согласие на обработку персональных данных</a>
              <a class="footer-quiz__docs-item" href="#">Согласие на получение информационной и рекламной рассылки</a>
              <a class="footer-quiz__docs-item" href="#">Пользовательское соглашение</a>
              <a class="footer-quiz__docs-item" href="#">Публичная Оферта</a>
              <a class="footer-quiz__docs-item" href="#">Соглашение на семейное обучение</a>
              <a class="footer-quiz__docs-item" href="#">Правила акции</a>
              <a class="footer-quiz__docs-item" href="#">Сведения об образовательной организации</a>
            </div>
          </div>
        </div>
        <div class="footer-quiz__right">
          <div class="footer-quiz__top">
            <a class="footer-quiz__email" href="mailto:support@tochka-school.ru">support@tochka-school.ru</a>
            <a class="footer-quiz__phone" href="tel:+7 (861) 217-64-77">+7 (861) 217-64-77</a>
          </div>
          <div class="footer-quiz__bottom">
            <div class="footer-quiz__address">350051, Краснодарский край,
              <br>г. Краснодар, ул. Монтажников, д. 5
            </div>
            <a class="footer-quiz__resident" href="https://sk.ru/" rel="nofollow" data-redirect>
              <img class="footer-quiz__resident-image" src="assets/img/sk_logo.svg" alt="">
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div id="captcha-container"></div>
  <script src="https://smartcaptcha.yandexcloud.net/captcha.js?render=onload&amp;onload=onloadFunction" defer></script>
  <script src="assets/js/jquery-3.4.0.min.js" defer></script>
  <script src="assets/js/libs.js" defer></script>
  <script src="assets/js/main.js" defer></script>
  <script>
      window.addEventListener("DOMContentLoaded", () => {
        const urlParams = location.search.slice(1); // убираем '?'
        // Проверка, начинается ли ссылка с одного из целевых URL
        function isTargetLink(href) {
          const targets = [
            "https://salebot.site/",
            "https://sbsite.pro/",
            "https://vk.com/app7062840"
          ];
          return targets.some(prefix => href.startsWith(prefix));
        }
      
        // Собираем значения из нужных cookie
        const cookies = ['_fbc', '_fbp', '_ga', '_ym_uid', 'roistat_visit'];
        let cookieParams = '';
      
        cookies.forEach(name => {
          const value = getCookie(name);
          if (value) {
            if (cookieParams) cookieParams += '&';
            cookieParams += `${name}='${encodeURIComponent(value)}'`;
          }
        });
      
        $('.pre_n_form').find(':input').each(function () {
          $(this).on('click', function (e) {
            // $( ".pre_n_form" ).find('.btn-warning').show();
            let button_pre = $( ".pre_n_form" ).find('.btn-warning');
            button_pre.removeAttr('disabled', true);
            button_pre.prop('disabled', false);
            button_pre.removeClass('loading');
            $('.v_messages').html('');
          });
        });
        $( ".pre_n_form" ).on( "submit", function( event ) {
          // $(this).find('.btn-warning').hide();
          let button_pre = $(this).find('.btn-warning');
          button_pre.attr('disabled', true);
          button_pre.prop('disabled', true);
          button_pre.addClass('loading');
        });
        try {
          const mask = (selector) => {
            function setMask() {
              let matrix = '+###############';
              maskList.forEach(item => {
                let code = item.code.replace(/[\\s#]/g, ''),
                        phone = this.value.replace(/[\\s#-)(]/g, '');
                if (phone.includes(code)) {
                  //console.log(phone, code);
                  matrix = item.code;
                }
              });
              let i = 0,
                      val = this.value.replace(/\\D/g, '');
              this.value = matrix.replace(/(?!\\+)./g, function(a) {
                return /[#\\d]/.test(a) && i < val.length ? val.charAt(i++) : i >= val.length ? '' : a;
              });
            }
            let inputs = document.querySelectorAll(selector);
            inputs.forEach(input => {
              input.addEventListener('focus', () => initInputHandlers(input), {once: true});
            });
            function initInputHandlers (input) {
              if (!input.value) input.value = '+';
              input.addEventListener('input', setMask);
              input.addEventListener('focus', setMask);
              input.addEventListener('blur', setMask);
            }
          };
          mask("[data-phone-pattern]");
        } catch (error) {
        }
        //     function setCookie(name, value, days) {
        //         let expires = "";
        //         if (days) {
        //             let date = new Date();
        //             date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        //             expires = "; expires=" + date.toUTCString();
        //         }
        //         document.cookie = name + "=" + (value || "") + expires + "; path=/";
        //     }
        //     function getCookie(name) {
        //         let matches = document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([\\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"));
        //         return matches ? decodeURIComponent(matches[1]) : undefined;
        //     }
        //     function checkCookies() {
        //         try{
        //         let cookieNote = document.getElementById('cookie_note_');
        //         let cookieBtnAccept = cookieNote.querySelector('.cookie_b');
        //         if (!getCookie('cookies_policy')) {
        //             cookieNote.classList.add('show');
        //         }
        //         cookieBtnAccept.addEventListener('click', function () {
        //             setCookie('cookies_policy', 'true', 365);
        //             cookieNote.classList.remove('show');
        //         });
        //         }catch(e){};
        //     }
        //     checkCookies();
        function insertBeforeAnchor(url, paramsToInsert) {
          const parts = url.split('#');
          if (parts.length === 1) {
            return `${url}${paramsToInsert}`;
          }
          return `${parts[0]}${paramsToInsert}#${parts[1]}`;
        }
      
        function getCookie(name) {
          let matches = document.cookie.match(new RegExp(
                  "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
          ));
          return matches ? decodeURIComponent(matches[1]) : undefined;
        }
      
        const advcake_track_id = getCookie('advcake_track_id')
        console.log(advcake_track_id)
      
        var search = "?" + window.location.search.split("&").filter(function (val) {
          var value = val.replace(/\?/, 'matematik-andrei.ru');
          //return value.indexOf("s_") === -1 && value.indexOf("tfc_") === -1;
          if (value.indexOf("s_") !== -1 || value.indexOf("tfc_") !== -1) {
            return false;
          }
          var parts = val.split('=');
          if (parts.length < 2) {
            return true;
          }
          var paramName = parts[0].replace(/^\?/, '');
          var paramValue = parts[1];
          var alphanumericRegex = /^[a-zA-Z0-9]{4,15}$/;
      
          if (paramName === 'promo') {
            if (!alphanumericRegex.test(paramValue)) {
              var cleanValue = paramValue.replace(/[^a-zA-Z0-9]/g, '');
              if (cleanValue.length < 4 || cleanValue.length > 15) {
                return false;
              }
              if (cleanValue !== paramValue) {
                return false;
              }
              parts[1] = cleanValue;
              return true;
            }
          }
          return true;
        }).join("&").replace(/\?/, "");
      
        const isUserFromSearch = document.referrer.includes("google") || document.referrer.includes("yandex")
        if (!search.includes('utm_source') && !search.includes('utm_campaign') && isUserFromSearch) {
          const blog_search = "utm_source=blog&utm_campaign=article"
          if (search.indexOf("?") === -1) {
            search += blog_search
          } else {
            search += blog_search.replace("?", "&")
          }
        }
      
        if (search !== "?") {
          var aLinks = document.querySelectorAll('a');
          var arrayLinks = Array.from(aLinks);
          arrayLinks.forEach(function (el) {
            var href = el.getAttribute("href");
            var data_noparam = el.getAttribute("data-noparam");
            if (href && href.indexOf("") > -1 && href.indexOf("#") === -1 && data_noparam != 'no') {
              if (isTargetLink(href)) {
                if (href.indexOf("?") === -1) {
                  href += search
                } else {
                  href += search.replace("?", "&")
                }
                if (cookieParams) {
                  if (href.startsWith("https://vk.com/app7062840")) {
                    href += "&" + cookieParams;
                  } else {
                    href += (href.includes("?") ? "&" : "?") + cookieParams;
                  }
                }
              } else {
                if (href.indexOf("?") === -1) {
                  href += search
                } else {
                  href += search.replace("?", "&")
                }
              }
              el.setAttribute("href", href)
              console.log("urlParams: " + urlParams)
              console.log("search: " + search)
              // if(el.classList.contains('btn_banner')){
              //     try{
              //         banner_href = el.getAttribute("href");
              //         banner_attr = el.getAttribute("banner-utm");
              //         el.setAttribute("href", banner_href + "&banner_utm=" + banner_attr);
              //     }catch(e){};
              // }
      
            }
          });
          try {
            if ($('.a_fpay').length > 0) {
              $('.a_fpay').each(function () {
                $(this).attr('href', insertBeforeAnchor($(this).attr('href'), search));
              });
            }
          } catch (e) {
          }
          ;
          try {
            if ($('.btn_fpay').length > 0) {
              // console.log(link_u);
              $('.btn_fpay').each(function () {
                $(this).attr('href', $(this).attr('href') + search);
                $(this).attr('old-href', $(this).attr('href'));
              });
              try {
                if ($('.price_input_f_pay').length > 0) {
                  $('.price_input_f_pay').each(function () {
                    $(this).attr('new-href', $(this).attr('new-href') + search);
                  });
                }
              } catch (e) {
              }
              ;
            }
      
            if ($('.btn_attr_fpay').length > 0) {
              $('.btn_attr_fpay').each(function () {
                $(this).attr('data-href-link', $(this).attr('data-href-link') + search);
              });
            }
          } catch (e) {
          }
          ;
      
          try {
            if ($('.input_utm').length > 0) {
              // console.log(link_u);
              $('.input_utm').each(function () {
                $(this).val(search);
              });
            }
            if ($('.utm_fpay').length > 0) {
              $('.utm_fpay').each(function () {
                $(this).attr('data-utm', search);
              });
            }
            //  if($('.ddocexp').length > 0){
            //      $('.ddocexp').each(function(){
            //          $(this).attr('data-docex', $(this).attr('data-docex')+search);
            //      });
            //  }
          } catch (e) {
          }
          ;
      
          try {
            if ($('.btn_fnoprpay').length > 0) {
              const params_all = new URLSearchParams(search);
              params_all.delete("promo");
              const updateSearchNopr = "?" + params_all.toString()
              // console.log(link_u);
              $('.btn_fnoprpay').each(function () {
                $(this).attr('href', $(this).attr('href') + updateSearchNopr);
                $(this).attr('old-href', $(this).attr('href'));
              });
              if ($('.utm_fnoprpay').length > 0) {
                $('.utm_fnoprpay').each(function () {
                  $(this).attr('data-utm', updateSearchNopr);
                });
              }
              try {
                if ($('.price_input_f_fnoprpay').length > 0) {
                  $('.price_input_f_fnoprpay').each(function () {
                    $(this).attr('new-href', $(this).attr('new-href') + updateSearchNopr);
                  });
                }
              } catch (e) {
              }
              ;
            }
            if ($('.btn_attr_fnoprpay').length > 0) {
              const attr_params_all = new URLSearchParams(search);
              attr_params_all.delete("promo");
              const attr_updateSearchNopr = "?" + attr_params_all.toString()
              $('.btn_attr_fnoprpay').each(function () {
                $(this).attr('data-href-link', $(this).attr('data-href-link') + attr_updateSearchNopr);
              });
            }
          } catch (e) {
          }
          ;
      
          try {
            const params = new URLSearchParams(search);
            params.delete("promo");
            const updateSearch = params.toString()
            if ($('.btn_fmpay').length > 0) {
              // console.log(link_u);
              $('.btn_fmpay').each(function () {
                $(this).attr('href', $(this).attr('href') + "?" + updateSearch);
              });
              try {
                if ($('.price_option_fm_pay').length > 0) {
                  $('.price_option_fm_pay').each(function () {
                    $(this).attr('data-product-link', $(this).attr('data-product-link') + "?" + updateSearch);
                  });
                }
              } catch (e) {
              }
              ;
            }
          } catch (e) {
          }
          ;
        }
        var banner_param_name = "?banner_utm=";
        if (search !== "?") {
          banner_param_name = "&banner_utm=";
        }
        try{
          var aBLinks = document.querySelectorAll('a.btn_banner');
          var arrayBLinks = Array.from(aBLinks);
          arrayBLinks.forEach(function (el) {
            banner_href = el.getAttribute("href");
            banner_attr = el.getAttribute("banner-utm");
            el.setAttribute("href", banner_href + banner_param_name + banner_attr);
          });
        }catch(e){};
        // });
      });
      const messageRutObj = {};
      const fWasLoaded = 0;
      function posterFrame(num_poster) {
        var posterWatch_count = 0;
        var handlePosterWatch = function( r_iframe ) {
          var handler = function(event) {
            var message = JSON.parse(event.data);
            //    messageRutObj[num_poster] = JSON.parse(event.data);
            //    var message = messageRutObj[num_poster];
            // console.log(message.type); // some type
            console.log(posterWatch_count);
            if(posterWatch_count == 0){
              console.log(message);
              switch (message.type) {
                case 'player:ready':
                  // console.log(message);
                  // if(r_iframe.getAttribute('data-vf') == num_poster){
                  if(messageRutObj[num_poster] != 1){
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:unMute',data: {time: 0}}), '*');
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:setCurrentTime',data: {time: 0}}), '*');
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:play',data: {}}), '*');
                  }
                  messageRutObj[num_poster] = 1;
                      // }
                      // $('.review_watch').each(function(){
                      //     if($(this).attr('data-pb') != num_poster){
                      //         let poster__iframe = document.querySelector('[data-vf="'+$(this).attr('data-pb')+'"]');
                      //         poster__iframe.contentWindow.postMessage(JSON.stringify({type: 'player:pause',data: {}}), '*');
                      //     }
                      // });
                case 'player:changeState':
                  // console.log(message);
                  if(message.data.state == 'playing'){
                    posterWatch_count++;
                  }
                case 'player:rollState':
                  // console.log(message.data.state);
                  // console.log(message);
                  if(message.data.state == 'play'){
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:pause',data: {}}), '*');
                  }
                  if(message.data.state == 'complete' ){
                    // if(r_iframe.getAttribute('data-vf') == num_poster){
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:setCurrentTime',data: {time: 0}}), '*');
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:play',data: {}}), '*');
                    posterWatch_count++;
                    // }
                    // $('.review_watch').each(function(){
                    //     let poster__iframe = document.querySelector('[data-vf="'+$(this).attr('data-pb')+'"]');
                    //     poster__iframe.contentWindow.postMessage(JSON.stringify({type: 'player:pause',data: {}}), '*');
                    // });
                    //window.removeEventListener("message", handlePosterWatch);
                    // console.log(message.data.state);
                  }
                      // break;
              };
            }
          };
          return handler;
        };
        var player_iframe = document.querySelector('[data-vf="'+num_poster+'"]');
        window.addEventListener('message', handlePosterWatch(player_iframe));
        // let player_iframe = document.querySelector('[data-vf="'+num_poster+'"]');
        // player_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:setCurrentTime',data: {time: 0}}), '*');
        // player_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:play',data: {}}), '*');
      }
      // Вызов функции при загрузке страницы и изменении размера окна
      document.addEventListener('DOMContentLoaded', (event) => {
        if($('.video-posters').length > 0 && $('.player-buttons').length > 0 && $('.video-iframes').length > 0){
          // console.log(link_u);
          $('.video-posters').each(function(){
            $(this).on('click', function () {
              $('[data-pb="'+$(this).attr('data-vp')+'"]').hide();
              $(this).hide();
              $('[data-vf="'+$(this).attr('data-vp')+'"]').show();
              $('[data-vf="'+$(this).attr('data-vp')+'"]').attr('src', $('[data-vf="'+$(this).attr('data-vp')+'"]').attr('data-src')+"&autoplay=1&playerId=9" );
              if($('[data-vf="'+$(this).attr('data-vp')+'"]').hasClass("review_watch")){
                let num_poster = $(this).attr('data-vp');
                setTimeout(posterFrame, 1000, num_poster);
              }
            });
          });
          $('.player-buttons').each(function(){
            $(this).on('click', function () {
              $('[data-vp="'+$(this).attr('data-pb')+'"]').hide();
              $(this).hide();
              $('[data-vf="'+$(this).attr('data-pb')+'"]').show();
              $('[data-vf="'+$(this).attr('data-pb')+'"]').attr('src', $('[data-vf="'+$(this).attr('data-pb')+'"]').attr('data-src')+"&autoplay=1&playerId=9" );
              if($('[data-vf="'+$(this).attr('data-pb')+'"]').hasClass("review_watch")){
                let num_poster = $(this).attr('data-pb');
                setTimeout(posterFrame, 1000, num_poster);
              }
            });
          });
        }
      });
    </script>
</body>

</html>