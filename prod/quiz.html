<!DOCTYPE html>
<html lang="ru">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2, minimum-scale=1.0">
  <meta name="author" content="Точка знаний">
  <meta name="description" content="Точка знаний">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="assets/css/main.css" />
  <link rel="apple-touch-icon-precomposed" sizes="57x57" href="assets/img/favicon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon-precomposed" sizes="114x114" href="assets/img/favicon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon-precomposed" sizes="72x72" href="assets/img/favicon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/img/favicon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon-precomposed" sizes="60x60" href="assets/img/favicon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon-precomposed" sizes="120x120" href="assets/img/favicon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon-precomposed" sizes="76x76" href="assets/img/favicon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon-precomposed" sizes="152x152" href="assets/img/favicon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="assets/img/favicon/favicon-128.png" sizes="128x128">
  <meta name="application-name" content=" ">
  <meta name="msapplication-TileColor" content="#FFFFFF">
  <meta name="msapplication-TileImage" content="assets/img/favicon/mstile-144x144.png">
  <meta name="msapplication-square70x70logo" content="assets/img/favicon/mstile-70x70.png">
  <meta name="msapplication-square150x150logo" content="assets/img/favicon/mstile-150x150.png">
  <meta name="msapplication-wide310x150logo" content="assets/img/favicon/mstile-310x150.png">
  <meta name="msapplication-square310x310logo" content="assets/img/favicon/mstile-310x310.png">
  <meta property="og:title" content="Точка знаний">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="Точка знаний">
  <meta property="og:description" content="Занятия для детей с 1 по 11 класс">
  <meta property="og:image" content="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
  <link rel="image_src" href="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
  <meta property="vk:image" content="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
  <meta property="og:url" content="https://tochka-school.ru">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="pointschool">
  <meta name="twitter:title" content="Точка знаний">
  <meta name="twitter:description" content="Занятия для детей с 1 по 11 класс">
  <meta name="twitter:image" content="https://tochka-school.ru/themes/school-point/assets/img/cover1.png">
</head>

<body>
  <main class="wrapper">
    <div class="quiz" id="quiz" data-element="quiz">
      <div class="quiz__cont cont">
        <div class="quiz__header">
          <div class="quiz__logo">
            <img class="quiz__logo-image" src="assets/img/logo.svg" alt="">
          </div>
        </div>
        <div class="quiz__wrap quiz__wrap_first-slide">
          <div class="quiz__decor quiz__decor_1"></div>
          <div class="quiz__decor quiz__decor_2"></div>
          <div class="quiz__decor quiz__decor_3"></div>
          <div class="quiz__decor quiz__decor_4"></div>
          <div class="quiz__decor quiz__decor_5"></div>
          <form class="quiz__form" id="quiz__form" data-element="quiz-form">
            <div class="quiz__progress hide" data-element="quiz-progress">
              <div class="quiz__progress-text">Прогресс опроса</div>
              <div class="quiz__progress-bar">
                <div class="quiz__progress-bar-fill" data-element="quiz-progress-bar-fill"></div>
              </div>
            </div>
            <div class="quiz__slide quiz__slide_1">
              <div class="quiz__inner active" data-element="quiz-inner">
                <div class="quiz__info">
                  <div class="quiz__caption">Важный опрос для участников предзаписи</div>
                  <div class="quiz__text">
                    Пожалуйста, ответьте на вопросы ниже. Исходя из Ваших ответов, мы спрогнозируем нагрузку на учителей и
                    тьюторов, а также найдём новых учителей, лучших в стране.
                  </div>
                  <div class="quiz__text">Если у Вас несколько детей, тогда пройдите опрос на каждого ребёнка отдельно.</div>
                  <div class="quiz__text">Итак, начнём.</div>
                </div>
                <div class="quiz__box">
                  <div class="quiz__headline">Имя и фамилия ребенка</div>
                  <div class="quiz__line">
                    <input class="quiz__input input-white" type="text" placeholder="Имя" name="name">
                    <input class="quiz__input input-white" type="text" placeholder="Фамилия" name="surname">
                    <button class="quiz__button btn-orange" data-element="quiz-next" type="button" disabled data-role="scroll-to-anchor" scroll-to-anchor-id="#quiz" scroll-offset="0">Дальше</button>
                  </div>
                </div>
              </div>
            </div>
            <div class="quiz__slide quiz__slide_2">
              <div class="quiz__inner" data-element="quiz-inner">
                <div class="quiz__title quiz__title_radio">В какой класс Ваш ребёнок идёт в следующем году</div>
                <div class="quiz__list" data-type="radio" data-list="[&quot;Дошкольник&quot;,&quot;в 1 класс&quot;,&quot;в 2 класс&quot;,&quot;в 3 класс&quot;,&quot;в 4 класс&quot;,&quot;в 5 класс&quot;,&quot;в 6 класс&quot;,&quot;в 7 класс&quot;,&quot;в 8 класс&quot;,&quot;в 9 класс&quot;,&quot;в 10 класс&quot;,&quot;в 11 класс&quot;]" data-name="class">
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="0">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">Дошкольник</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="1">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 1 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="2">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 2 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="3">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 3 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="4">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 4 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="5">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 5 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="6">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 6 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="7">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 7 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="8">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 8 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="9">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 9 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="10">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 10 класс</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="class" value="11">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">в 11 класс</div>
                  </label>
                </div>
                <div class="quiz__buttons">
                  <button class="quiz__button btn-orange" data-element="quiz-next" type="button" disabled>Дальше</button>
                  <button class="quiz__back" type="button" data-element="quiz-prev">Вернуться назад</button>
                </div>
              </div>
            </div>
            <div class="quiz__slide quiz__slide_3">
              <div class="quiz__inner" data-element="quiz-inner">
                <div class="quiz__title quiz__title_radio">Вы планируете обучаться на семейном обучении с&nbsp;сентября 2025 года?</div>
                <div class="quiz__note">Учиться дома, онлайн. Изучать все предметы, как в обычной школе, сдавать контрольные и аттестацию онлайн.</div>
                <div class="quiz__list" data-type="radio" data-list="[&quot;Да&quot;,&quot;Нет&quot;,&quot;Ещё не решили&quot;]" data-name="family-education-plan">
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="family-education-plan" value="Да">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">Да</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="family-education-plan" value="Нет">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">Нет</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="family-education-plan" value="Ещё не решили">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">Ещё не решили</div>
                  </label>
                </div>
                <div class="quiz__buttons">
                  <button class="quiz__button btn-orange" data-element="quiz-next" type="button" disabled>Дальше</button>
                  <button class="quiz__back" type="button" data-element="quiz-prev">Вернуться назад</button>
                </div>
              </div>
            </div>
            <div class="quiz__slide quiz__slide_4">
              <div class="quiz__inner" data-element="quiz-inner">
                <input class="quiz__hidden-checkbox" type="hidden" name="courses">
                <div class="quiz__title quiz__title_checkbox">На курсы по каким школьным предметам Вы планируете записаться?</div>
                <div class="quiz__list" data-element="quiz-generate" data-type="checkbox" data-list="list_4" data-name="courses">
                </div>
                <div class="quiz__buttons">
                  <button class="quiz__button btn-orange" data-element="quiz-next" type="button" disabled>Дальше</button>
                  <button class="quiz__back" type="button" data-element="quiz-prev">Вернуться назад</button>
                </div>
              </div>
            </div>
            <div class="quiz__slide quiz__slide_5">
              <div class="quiz__inner" data-element="quiz-inner">
                <input class="quiz__hidden-checkbox" type="hidden" name="additional-courses">
                <div class="quiz__title quiz__title_checkbox">Отметьте дополнительные курсы, на которые планируете записаться:</div>
                <div class="quiz__list" data-element="quiz-generate" data-type="checkbox" data-list="list_5" data-name="additional-courses">
                </div>
                <div class="quiz__buttons">
                  <button class="quiz__button btn-orange" data-element="quiz-next" type="button" disabled>Дальше</button>
                  <button class="quiz__back" type="button" data-element="quiz-prev">Вернуться назад</button>
                </div>
              </div>
            </div>
            <div class="quiz__slide quiz__slide_6">
              <div class="quiz__inner" data-element="quiz-inner">
                <div class="quiz__title quiz__title_radio">Вы учились у нас ранее?</div>
                <div class="quiz__list" data-type="radio" data-list="[&quot;Да&quot;,&quot;Нет&quot;]" data-name="already-studied">
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="already-studied" value="Да">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">Да</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="radio" name="already-studied" value="Нет">
                    <div class="quiz__input-view quiz__input-view_radio"></div>
                    <div class="quiz__input-text">Нет</div>
                  </label>
                </div>
                <div class="quiz__buttons">
                  <button class="quiz__button btn-orange" data-element="quiz-next" type="button" disabled>Дальше</button>
                  <button class="quiz__back" type="button" data-element="quiz-prev">Вернуться назад</button>
                </div>
              </div>
            </div>
            <div class="quiz__slide quiz__slide_7">
              <div class="quiz__inner" data-element="quiz-inner">
                <input class="quiz__hidden-checkbox" type="hidden" name="events">
                <div class="quiz__title quiz__title_checkbox">В каких мероприятиях «Точки Знаний» Вы уже принимали участие</div>
                <div class="quiz__list" data-type="checkbox" data-list="[&quot;Пробная неделя&quot;,&quot;Осенний марафон&quot;,&quot;IT-марафон&quot;,&quot;Пробные уроки&quot;,&quot;Открытые уроки&quot;,&quot;Вебинары&quot;,&quot;Не принимал участия&quot;]" data-name="events">
                  <label class="quiz__label">
                    <input class="quiz__input" type="checkbox" value="Пробная неделя">
                    <div class="quiz__input-view quiz__input-view_checkbox"></div>
                    <div class="quiz__input-text">Пробная неделя</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="checkbox" value="Осенний марафон">
                    <div class="quiz__input-view quiz__input-view_checkbox"></div>
                    <div class="quiz__input-text">Осенний марафон</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="checkbox" value="IT-марафон">
                    <div class="quiz__input-view quiz__input-view_checkbox"></div>
                    <div class="quiz__input-text">IT-марафон</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="checkbox" value="Пробные уроки">
                    <div class="quiz__input-view quiz__input-view_checkbox"></div>
                    <div class="quiz__input-text">Пробные уроки</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="checkbox" value="Открытые уроки">
                    <div class="quiz__input-view quiz__input-view_checkbox"></div>
                    <div class="quiz__input-text">Открытые уроки</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="checkbox" value="Вебинары">
                    <div class="quiz__input-view quiz__input-view_checkbox"></div>
                    <div class="quiz__input-text">Вебинары</div>
                  </label>
                  <label class="quiz__label">
                    <input class="quiz__input" type="checkbox" value="Не принимал участия">
                    <div class="quiz__input-view quiz__input-view_checkbox"></div>
                    <div class="quiz__input-text">Не принимал участия</div>
                  </label>
                </div>
                <div class="quiz__buttons">
                  <button class="quiz__button btn-orange" data-element="quiz-next" type="submit" disabled>Отправить ответы</button>
                  <button class="quiz__back" type="button" data-element="quiz-prev">Вернуться назад</button>
                </div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </main>
  <script src="assets/js/jquery-3.4.0.min.js" defer></script>
  <script src="assets/js/libs.js" defer></script>
  <script src="assets/js/main.js" defer></script>
  <script>
      window.addEventListener("DOMContentLoaded", () => {
        const urlParams = location.search.slice(1); // убираем '?'
        // Проверка, начинается ли ссылка с одного из целевых URL
        function isTargetLink(href) {
          const targets = [
            "https://salebot.site/",
            "https://sbsite.pro/",
            "https://vk.com/app7062840"
          ];
          return targets.some(prefix => href.startsWith(prefix));
        }
      
        // Собираем значения из нужных cookie
        const cookies = ['_fbc', '_fbp', '_ga', '_ym_uid', 'roistat_visit'];
        let cookieParams = '';
      
        cookies.forEach(name => {
          const value = getCookie(name);
          if (value) {
            if (cookieParams) cookieParams += '&';
            cookieParams += `${name}='${encodeURIComponent(value)}'`;
          }
        });
      
        $('.pre_n_form').find(':input').each(function () {
          $(this).on('click', function (e) {
            // $( ".pre_n_form" ).find('.btn-warning').show();
            let button_pre = $( ".pre_n_form" ).find('.btn-warning');
            button_pre.removeAttr('disabled', true);
            button_pre.prop('disabled', false);
            button_pre.removeClass('loading');
            $('.v_messages').html('');
          });
        });
        $( ".pre_n_form" ).on( "submit", function( event ) {
          // $(this).find('.btn-warning').hide();
          let button_pre = $(this).find('.btn-warning');
          button_pre.attr('disabled', true);
          button_pre.prop('disabled', true);
          button_pre.addClass('loading');
        });
        try {
          const mask = (selector) => {
            function setMask() {
              let matrix = '+###############';
              maskList.forEach(item => {
                let code = item.code.replace(/[\\s#]/g, ''),
                        phone = this.value.replace(/[\\s#-)(]/g, '');
                if (phone.includes(code)) {
                  //console.log(phone, code);
                  matrix = item.code;
                }
              });
              let i = 0,
                      val = this.value.replace(/\\D/g, '');
              this.value = matrix.replace(/(?!\\+)./g, function(a) {
                return /[#\\d]/.test(a) && i < val.length ? val.charAt(i++) : i >= val.length ? '' : a;
              });
            }
            let inputs = document.querySelectorAll(selector);
            inputs.forEach(input => {
              input.addEventListener('focus', () => initInputHandlers(input), {once: true});
            });
            function initInputHandlers (input) {
              if (!input.value) input.value = '+';
              input.addEventListener('input', setMask);
              input.addEventListener('focus', setMask);
              input.addEventListener('blur', setMask);
            }
          };
          mask("[data-phone-pattern]");
        } catch (error) {
        }
        //     function setCookie(name, value, days) {
        //         let expires = "";
        //         if (days) {
        //             let date = new Date();
        //             date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        //             expires = "; expires=" + date.toUTCString();
        //         }
        //         document.cookie = name + "=" + (value || "") + expires + "; path=/";
        //     }
        //     function getCookie(name) {
        //         let matches = document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([\\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"));
        //         return matches ? decodeURIComponent(matches[1]) : undefined;
        //     }
        //     function checkCookies() {
        //         try{
        //         let cookieNote = document.getElementById('cookie_note_');
        //         let cookieBtnAccept = cookieNote.querySelector('.cookie_b');
        //         if (!getCookie('cookies_policy')) {
        //             cookieNote.classList.add('show');
        //         }
        //         cookieBtnAccept.addEventListener('click', function () {
        //             setCookie('cookies_policy', 'true', 365);
        //             cookieNote.classList.remove('show');
        //         });
        //         }catch(e){};
        //     }
        //     checkCookies();
        function insertBeforeAnchor(url, paramsToInsert) {
          const parts = url.split('#');
          if (parts.length === 1) {
            return `${url}${paramsToInsert}`;
          }
          return `${parts[0]}${paramsToInsert}#${parts[1]}`;
        }
      
        function getCookie(name) {
          let matches = document.cookie.match(new RegExp(
                  "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
          ));
          return matches ? decodeURIComponent(matches[1]) : undefined;
        }
      
        const advcake_track_id = getCookie('advcake_track_id')
        console.log(advcake_track_id)
      
        var search = "?" + window.location.search.split("&").filter(function(val) {
          var value = val.replace(/\\?/, 'matematik-andrei.ru');
          return value.indexOf("s_") === -1 && value.indexOf("tfc_") === -1;
        }).join("&").replace(/\\?/, "");
        if (search !== "?") {
          var aLinks = document.querySelectorAll('a');
          var arrayLinks = Array.from(aLinks);
          arrayLinks.forEach(function (el) {
            var href = el.getAttribute("href");
            var data_noparam = el.getAttribute("data-noparam");
            if (href && href.indexOf("") > -1 && href.indexOf("#") === -1 && data_noparam != 'no') {
              if (isTargetLink(href)) {
                if (href.indexOf("?") === -1) {
                  href += search
                } else {
                  href += search.replace("?", "&")
                }
                if (cookieParams) {
                  if (href.startsWith("https://vk.com/app7062840")) {
                    href += "&" + cookieParams;
                  } else {
                    href += (href.includes("?") ? "&" : "?") + cookieParams;
                  }
                }
              } else {
                if (href.indexOf("?") === -1) {
                  href += search
                } else {
                  href += search.replace("?", "&")
                }
              }
              el.setAttribute("href", href)
              console.log("urlParams: " + urlParams)
              console.log("search: " + search)
              // if(el.classList.contains('btn_banner')){
              //     try{
              //         banner_href = el.getAttribute("href");
              //         banner_attr = el.getAttribute("banner-utm");
              //         el.setAttribute("href", banner_href + "&banner_utm=" + banner_attr);
              //     }catch(e){};
              // }
      
            }
          });
          try {
            if ($('.a_fpay').length > 0) {
              $('.a_fpay').each(function () {
                $(this).attr('href', insertBeforeAnchor($(this).attr('href'), search));
              });
            }
          } catch (e) {
          }
          ;
          try {
            if ($('.btn_fpay').length > 0) {
              // console.log(link_u);
              $('.btn_fpay').each(function () {
                $(this).attr('href', $(this).attr('href') + search);
                $(this).attr('old-href', $(this).attr('href'));
              });
              try {
                if ($('.price_input_f_pay').length > 0) {
                  $('.price_input_f_pay').each(function () {
                    $(this).attr('new-href', $(this).attr('new-href') + search);
                  });
                }
              } catch (e) {
              }
              ;
            }
      
            if ($('.btn_attr_fpay').length > 0) {
              $('.btn_attr_fpay').each(function () {
                $(this).attr('data-href-link', $(this).attr('data-href-link') + search);
              });
            }
          } catch (e) {
          }
          ;
      
          try {
            if ($('.input_utm').length > 0) {
              // console.log(link_u);
              $('.input_utm').each(function () {
                $(this).val(search);
              });
            }
            if ($('.utm_fpay').length > 0) {
              $('.utm_fpay').each(function () {
                $(this).attr('data-utm', search);
              });
            }
            //  if($('.ddocexp').length > 0){
            //      $('.ddocexp').each(function(){
            //          $(this).attr('data-docex', $(this).attr('data-docex')+search);
            //      });
            //  }
          } catch (e) {
          }
          ;
      
          try {
            if ($('.btn_fnoprpay').length > 0) {
              const params_all = new URLSearchParams(search);
              params_all.delete("promo");
              const updateSearchNopr = "?" + params_all.toString()
              // console.log(link_u);
              $('.btn_fnoprpay').each(function () {
                $(this).attr('href', $(this).attr('href') + updateSearchNopr);
                $(this).attr('old-href', $(this).attr('href'));
              });
              if ($('.utm_fnoprpay').length > 0) {
                $('.utm_fnoprpay').each(function () {
                  $(this).attr('data-utm', updateSearchNopr);
                });
              }
              try {
                if ($('.price_input_f_fnoprpay').length > 0) {
                  $('.price_input_f_fnoprpay').each(function () {
                    $(this).attr('new-href', $(this).attr('new-href') + updateSearchNopr);
                  });
                }
              } catch (e) {
              }
              ;
            }
            if ($('.btn_attr_fnoprpay').length > 0) {
              const attr_params_all = new URLSearchParams(search);
              attr_params_all.delete("promo");
              const attr_updateSearchNopr = "?" + attr_params_all.toString()
              $('.btn_attr_fnoprpay').each(function () {
                $(this).attr('data-href-link', $(this).attr('data-href-link') + attr_updateSearchNopr);
              });
            }
          } catch (e) {
          }
          ;
      
          try {
            const params = new URLSearchParams(search);
            params.delete("promo");
            const updateSearch = params.toString()
            if ($('.btn_fmpay').length > 0) {
              // console.log(link_u);
              $('.btn_fmpay').each(function () {
                $(this).attr('href', $(this).attr('href') + "?" + updateSearch);
              });
              try {
                if ($('.price_option_fm_pay').length > 0) {
                  $('.price_option_fm_pay').each(function () {
                    $(this).attr('data-product-link', $(this).attr('data-product-link') + "?" + updateSearch);
                  });
                }
              } catch (e) {
              }
              ;
            }
          } catch (e) {
          }
          ;
        }
        var banner_param_name = "?banner_utm=";
        if (search !== "?") {
          banner_param_name = "&banner_utm=";
        }
        try{
          var aBLinks = document.querySelectorAll('a.btn_banner');
          var arrayBLinks = Array.from(aBLinks);
          arrayBLinks.forEach(function (el) {
            banner_href = el.getAttribute("href");
            banner_attr = el.getAttribute("banner-utm");
            el.setAttribute("href", banner_href + banner_param_name + banner_attr);
          });
        }catch(e){};
        // });
      });
      const messageRutObj = {};
      const fWasLoaded = 0;
      function posterFrame(num_poster) {
        var posterWatch_count = 0;
        var handlePosterWatch = function( r_iframe ) {
          var handler = function(event) {
            var message = JSON.parse(event.data);
            //    messageRutObj[num_poster] = JSON.parse(event.data);
            //    var message = messageRutObj[num_poster];
            // console.log(message.type); // some type
            console.log(posterWatch_count);
            if(posterWatch_count == 0){
              console.log(message);
              switch (message.type) {
                case 'player:ready':
                  // console.log(message);
                  // if(r_iframe.getAttribute('data-vf') == num_poster){
                  if(messageRutObj[num_poster] != 1){
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:unMute',data: {time: 0}}), '*');
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:setCurrentTime',data: {time: 0}}), '*');
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:play',data: {}}), '*');
                  }
                  messageRutObj[num_poster] = 1;
                      // }
                      // $('.review_watch').each(function(){
                      //     if($(this).attr('data-pb') != num_poster){
                      //         let poster__iframe = document.querySelector('[data-vf="'+$(this).attr('data-pb')+'"]');
                      //         poster__iframe.contentWindow.postMessage(JSON.stringify({type: 'player:pause',data: {}}), '*');
                      //     }
                      // });
                case 'player:changeState':
                  // console.log(message);
                  if(message.data.state == 'playing'){
                    posterWatch_count++;
                  }
                case 'player:rollState':
                  // console.log(message.data.state);
                  // console.log(message);
                  if(message.data.state == 'play'){
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:pause',data: {}}), '*');
                  }
                  if(message.data.state == 'complete' ){
                    // if(r_iframe.getAttribute('data-vf') == num_poster){
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:setCurrentTime',data: {time: 0}}), '*');
                    r_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:play',data: {}}), '*');
                    posterWatch_count++;
                    // }
                    // $('.review_watch').each(function(){
                    //     let poster__iframe = document.querySelector('[data-vf="'+$(this).attr('data-pb')+'"]');
                    //     poster__iframe.contentWindow.postMessage(JSON.stringify({type: 'player:pause',data: {}}), '*');
                    // });
                    //window.removeEventListener("message", handlePosterWatch);
                    // console.log(message.data.state);
                  }
                      // break;
              };
            }
          };
          return handler;
        };
        var player_iframe = document.querySelector('[data-vf="'+num_poster+'"]');
        window.addEventListener('message', handlePosterWatch(player_iframe));
        // let player_iframe = document.querySelector('[data-vf="'+num_poster+'"]');
        // player_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:setCurrentTime',data: {time: 0}}), '*');
        // player_iframe.contentWindow.postMessage(JSON.stringify({type: 'player:play',data: {}}), '*');
      }
      // Вызов функции при загрузке страницы и изменении размера окна
      document.addEventListener('DOMContentLoaded', (event) => {
        if($('.video-posters').length > 0 && $('.player-buttons').length > 0 && $('.video-iframes').length > 0){
          // console.log(link_u);
          $('.video-posters').each(function(){
            $(this).on('click', function () {
              $('[data-pb="'+$(this).attr('data-vp')+'"]').hide();
              $(this).hide();
              $('[data-vf="'+$(this).attr('data-vp')+'"]').show();
              $('[data-vf="'+$(this).attr('data-vp')+'"]').attr('src', $('[data-vf="'+$(this).attr('data-vp')+'"]').attr('data-src')+"&autoplay=1&playerId=9" );
              if($('[data-vf="'+$(this).attr('data-vp')+'"]').hasClass("review_watch")){
                let num_poster = $(this).attr('data-vp');
                setTimeout(posterFrame, 1000, num_poster);
              }
            });
          });
          $('.player-buttons').each(function(){
            $(this).on('click', function () {
              $('[data-vp="'+$(this).attr('data-pb')+'"]').hide();
              $(this).hide();
              $('[data-vf="'+$(this).attr('data-pb')+'"]').show();
              $('[data-vf="'+$(this).attr('data-pb')+'"]').attr('src', $('[data-vf="'+$(this).attr('data-pb')+'"]').attr('data-src')+"&autoplay=1&playerId=9" );
              if($('[data-vf="'+$(this).attr('data-pb')+'"]').hasClass("review_watch")){
                let num_poster = $(this).attr('data-pb');
                setTimeout(posterFrame, 1000, num_poster);
              }
            });
          });
        }
      });
    </script>
</body>

</html>